name: Build & Upload iOS (Unity Offline)

on:
  workflow_dispatch:

jobs:
  build-ios:
    runs-on: macos-latest
    env:
      UNITY_VERSION: 2022.3.62f2
      PROJECT_PATH: .
      BUILD_PATH: build/iOS
      APP_NAME: "V's æ¥é¾"
      BUNDLE_ID: com.highlight.solitaire
      APP_VERSION: 20251107

    steps:
      - uses: actions/checkout@v4

      # ğŸ§© å®‰è£ Unity ä¸¦å•Ÿç”¨ Personal License
      - name: Activate Unity License
        uses: webbertakken/unity-activate@v1
        with:
          unityVersion: ${{ env.UNITY_VERSION }}
          personalLicense: ${{ secrets.UNITY_LICENSE }}

      # ğŸ§© ä½¿ç”¨ Unity å»ºæ§‹ iOS å°ˆæ¡ˆ
      - name: Build iOS Project
        uses: webbertakken/unity-builder@v2
        with:
          targetPlatform: iOS
          unityVersion: ${{ env.UNITY_VERSION }}
          projectPath: ${{ env.PROJECT_PATH }}
          buildName: ${{ env.APP_NAME }}
          version: ${{ env.APP_VERSION }}
          buildMethod: ""
          allowDirtyBuild: true

      # ğŸ§© å„²å­˜æˆå“ (Xcode å°ˆæ¡ˆè³‡æ–™å¤¾)
      - name: Upload Build Output
        uses: actions/upload-artifact@v4
        with:
          name: iOS-Build
          path: build/iOS
